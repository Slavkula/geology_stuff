import tkinter as tk
from tkinter import filedialog
import openpyxl
from docx import Document

def create_new_file():
    excel_file_path = excel_file_entry.get()
    word_file_path = word_file_entry.get()

    workbook = openpyxl.load_workbook(excel_file_path)
    sheet = workbook.active
    doc = Document(word_file_path)
    new_doc = Document()

    for row in range(1, 110):  
        value1 = sheet.cell(row, 1).value
        value2 = sheet.cell(row, 2).value
        value3 = sheet.cell(row, 3).value

        if value1 is not None and value2 is not None and value3 is not None:
            for paragraph in doc.paragraphs:
                updated_text = paragraph.text.replace('ЭТО1', str(value1))
                updated_text = updated_text.replace('ЭТО2', str(value2))
                updated_text = updated_text.replace('ЭТО3', str(value3))
                new_doc.add_paragraph(updated_text)

    new_file_path = filedialog.asksaveasfilename(filetypes=[("Word files", "*.docx")])
    if new_file_path:
        new_doc.save('готовый файл.docx')

def browse_excel_file():
    excel_file_path = filedialog.askopenfilename(filetypes=[("Excel files", "*.xlsx")])
    excel_file_entry.delete(0, tk.END)
    excel_file_entry.insert(0, excel_file_path)

def browse_word_file():
    word_file_path = filedialog.askopenfilename(filetypes=[("Word files", "*.docx")])
    word_file_entry.delete(0, tk.END)
    word_file_entry.insert(0, word_file_path)

root = tk.Tk()
root.title("File Processor")

excel_file_label = tk.Label(root, text="Выберите файл Excel:")
excel_file_label.pack()
excel_file_entry = tk.Entry(root, width=50)
excel_file_entry.pack()
excel_file_button = tk.Button(root, text="Обзор", command=browse_excel_file)
excel_file_button.pack()

word_file_label = tk.Label(root, text="Выберите файл Word:")
word_file_label.pack()
word_file_entry = tk.Entry(root, width=50)
word_file_entry.pack()
word_file_button = tk.Button(root, text="Обзор", command=browse_word_file)
word_file_button.pack()

create_file_button = tk.Button(root, text="Создать файл", command=create_new_file)
create_file_button.pack()

root.mainloop()
